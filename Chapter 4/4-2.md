## 滚动条
滚动条支持垂直方向也支持水平方向。使用者可以用鼠标在滚动条两端的箭头上或者箭头间的区域中点一下，也可以拖动卷动方块到特定的位置。  
当我们需要给窗口包含滚动条功能时，只需要在CreateWindow的第三个参数中包含窗口样式WS_VSCROLL和WS_HSCROLL就可以了。  
### 滚动条的范围和位置
每个滚动条都有一个相关的范围（这是一对整数，分别代表最小和最大值）和位置（标识卷动方块在滚动条内的位置）。当卷动方块在最上和最左，则它的位置在范围的最小值，反之亦然。  
在内定情况下，范围从0（顶部或左部）到100（底部或右步）。  
但是将范围改变为更方便于程序理解的数值也时很容易的：  
`SetScrollRange(hwnd, iBar, iMin, iMax, bRedraw);`  
参数iBar为SB_VERT或者SB_HORZ，iMin和iMax分别代表最大和最小值。最后一个参数TRUE或者FALSE代表需不需要根据新范围重画滚动条。   
卷动方块的位置总是整数值。例如，范围为0-4的滚动条有5个位置分别是01234。  
可以使用SetScrollPos在滚动条范围内设置新的卷动方块位置：  
`SetScrollPos(hwnd, iBar, iPos, bRedraw);`  
iPos是新位置，他必须在范围之间。windows提供了函数（GetScrollRange和GetScrollPos）来取得滚动条的目前范围和位置。  
##### windows对滚动条的处理
处理所有滚动条鼠标事件  
当使用者在滚动条内单机鼠标，提供一种反向显示的闪烁  
当使用者在滚动条内拖动卷动方块，移动卷动方块  
为包含滚动条窗口的窗口消息处理程序发送滚动条消息  
##### 程序写作者需要完成的工作  
初始化滚动条的范围和位置SetScrollRange和SetScrollPos  
处理窗口消息处理程序的滚动条消息  
更新滚动条内卷动方块的位置  
更改显示区域的内容以相应卷动条的更改  
### 滚动条消息
用鼠标单击滚动条或者拖动卷动方块时，windows会发送消息WM_VSCROLL和WM_HSCROLL。每个鼠标动作都会产生至少两个消息，一条在按下鼠标产生，一条在放开鼠标产生。和所有消息一样，他们也带有wParam和lParam消息参数。  
我们可以忽略这2个消息的lParam，它只用于作为**子窗口**而建立的滚动条（通常在对话框内）。   
wParam消息参数分为低字节和高字节。低字节是一个数值，它指出了鼠标对滚动条进行的操作以通知码的形式存在。如：  
SB_LINEUP SB_LINELEFT SB_LINEDOWN SB_LINERIGHT  
SB_PAGEUP SB_PAGELEFT SB_PAGEDOWN SB_PAGERIGHT  
SB_THUMBPOSITION SB_THUMBTRACK   
SB_TOP SB_LEFT SB_BOTTOM SB_RIGHT SB_ENDSCROLL  
![](https://github.com/sii2017/image/blob/master/scroll.jpg)  
如上所说，鼠标按下会产生至少两个消息。按下的时候会产生各个滚动条消息，而放开后会收到SB_ENDSCROLL通知码消息一般可以忽略。  
当鼠标放在卷动方块上并按住鼠标拖动方块则会产生SB_THUMBTRACK和SB_THUMBPOSITION通知码的滚动消息。  
当滚动条消息的低字节是SB_THUMBTRACK时，高字节就是方块的目前位置。  
当滚动条消息的低字节是SB_THUMBPOSITION时，高字节是方块的最终位置。  
对于其他消息，仅处理低字节就可以了，高字节应该被忽略。  
注意：尽管当我们拖动方块时，方块会移动并且windows会发送消息。但是如果我们不在消息中用SetScrollPos来处理方块位置，放开鼠标后方块会回到原来的位置。  
程序一般能处理SB_THUMBTRACK和SB_THUMBPOSITION消息，但是一般不同时处理。可以想象处理前者，画面会随着鼠标而改变，处理后者仅仅是拖动到位置放开鼠标后画面会刷新。所以理论上处理前者的视觉效果会更好。  
此外还有SB_TOP SB_BOTTOM SB_LEFT SB_RIGHT通知码，指出滚动条已经到了最小或最大位置。但是作为应用程序窗口的一部分，永远也不会收到他们。  
### 在SYSMETS中加入卷动功能  
参考SYSMETS2.C  
### 绘图程序的组织
## 建立更好的滚动
### 滚动条信息函数
### 卷动范围
### 新SYSMETS
参考STSMETS3.C  
### 不用鼠标的情况